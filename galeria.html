<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galeria de Fotos - Fotos63</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        :root {
            --primary-yellow: #FFD700;
            --primary-orange: #FF8C00;
            --gradient-primary: linear-gradient(135deg, #FFD700 0%, #FF8C00 100%);
            --dark-gray: #2C3E50;
            --medium-gray: #7F8C8D;
            --light-gray: #F8F9FA;
            --white: #FFFFFF;
            --success: #27AE60;
            --danger: #E74C3C;
            --warning: #F39C12;
            --info: #3498DB;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            line-height: 1.6;
            color: var(--dark-gray);
            background: var(--light-gray);
        }

        .navbar {
            background: white !important;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .navbar-brand {
            font-weight: bold;
            color: var(--primary-color) !important;
        }

        .hero-section {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 60px 0;
            margin-bottom: 40px;
        }

        .search-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }

        .photo-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .photo-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .photo-card img {
            width: 100%;
            height: 250px;
            object-fit: cover;
        }

        .photo-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, transparent 0%, rgba(0,0,0,0.7) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
            display: flex;
            align-items: flex-end;
            padding: 20px;
            color: white;
        }

        .photo-card:hover .photo-overlay {
            opacity: 1;
        }

        .photo-info {
            padding: 20px;
        }

        .photo-price {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--success-color);
        }

        .photographer-info {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }

        .photographer-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            margin-right: 10px;
            object-fit: cover;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            border: none;
            border-radius: 25px;
            padding: 10px 25px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(243, 156, 18, 0.4);
        }

        .filter-section {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .category-filter {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .category-btn {
            padding: 8px 16px;
            border: 2px solid var(--primary-color);
            background: transparent;
            color: var(--primary-color);
            border-radius: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .category-btn.active,
        .category-btn:hover {
            background: var(--primary-color);
            color: white;
        }

        .stats-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .loading-spinner {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }

        .footer {
            background: var(--dark-color);
            color: white;
            text-align: center;
            padding: 40px 0;
            margin-top: 60px;
        }

        .login-prompt {
            background: rgba(243, 156, 18, 0.1);
            border: 1px solid var(--primary-color);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            text-align: center;
        }

        .watermark {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8rem;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <i class="bi bi-camera-fill me-2"></i>Fotos63
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Início</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="galeria.html">Galeria</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="eventos.html">Eventos</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="index.html#fotografos">Fotógrafos</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="index.html#sobre">Sobre</a>
                    </li>
                </ul>
                
                <div class="d-flex">
                    <button class="btn btn-primary me-2" onclick="showRegister()">
                        <i class="bi bi-person-plus"></i>
                        Cadastrar
                    </button>
                    <button class="btn btn-outline-primary" onclick="showLogin()">
                        <i class="bi bi-box-arrow-in-right"></i>
                        Entrar
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <h1 class="display-4 fw-bold mb-3">Explore Nossa Galeria</h1>
                    <p class="lead mb-4">Descubra fotos incríveis do Tocantins capturadas por fotógrafos talentosos. Navegue, explore e encontre a imagem perfeita para seu projeto.</p>
                </div>
                <div class="col-lg-4 text-center">
                    <i class="bi bi-images" style="font-size: 6rem; opacity: 0.3;"></i>
                </div>
            </div>
        </div>
    </section>

    <div class="container">
        <!-- Stats Section -->
        <div class="stats-section">
            <div class="row">
                <div class="col-md-3">
                    <div class="stat-item">
                        <div class="stat-number" id="totalPhotos">0</div>
                        <p class="text-muted">Fotos Disponíveis</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-item">
                        <div class="stat-number" id="totalPhotographers">0</div>
                        <p class="text-muted">Fotógrafos</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-item">
                        <div class="stat-number" id="totalCategories">6</div>
                        <p class="text-muted">Categorias</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-item">
                        <div class="stat-number">100%</div>
                        <p class="text-muted">Qualidade</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Search Section -->
        <div class="search-section">
            <h3 class="mb-4">Encontre a Foto Perfeita</h3>
            <div class="row">
                <div class="col-md-8">
                    <div class="input-group">
                        <input type="text" class="form-control form-control-lg" id="searchInput" 
                               placeholder="Buscar por título, descrição, fotógrafo...">
                        <button class="btn btn-primary" onclick="searchPhotos()">
                            <i class="bi bi-search"></i>
                        </button>
                    </div>
                </div>
                <div class="col-md-4">
                    <select class="form-control form-control-lg" id="sortSelect" onchange="sortPhotos()">
                        <option value="recent">Mais Recentes</option>
                        <option value="price_asc">Menor Preço</option>
                        <option value="price_desc">Maior Preço</option>
                        <option value="popular">Mais Populares</option>
                        <option value="title">A-Z</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Filter Section -->
        <div class="filter-section">
            <h5 class="mb-3">Filtros Avançados</h5>
            <div class="row">
                <div class="col-md-2">
                    <label class="form-label">Evento</label>
                    <select class="form-control" id="eventoFilter" onchange="applyFilters()">
                        <option value="">Todos os Eventos</option>
                        <option value="rei-rainha-via-lago">Rei e Rainha da Via Lago</option>
                        <option value="corrida-trabalhador">Corrida do Trabalhador</option>
                        <option value="desafio-bravos">Desafio Bravos</option>
                        <option value="stives-race">Stive's Race</option>
                        <option value="corrida-sesc">Corrida do SESC</option>
                        <option value="corrida-outubro-rosa">Corrida Outubro Rosa</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <label class="form-label">Esporte</label>
                    <select class="form-control" id="esporteFilter" onchange="applyFilters()">
                        <option value="">Todos os Esportes</option>
                        <option value="corrida">Corrida</option>
                        <option value="ciclismo">Ciclismo</option>
                        <option value="natacao">Natação</option>
                        <option value="triathlon">Triathlon</option>
                        <option value="caminhada">Caminhada</option>
                        <option value="aventura">Aventura</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <label class="form-label">Fotógrafo</label>
                    <select class="form-control" id="fotografoFilter" onchange="applyFilters()">
                        <option value="">Todos os Fotógrafos</option>
                        <option value="thayson-ruivo">Thayson Ruivo</option>
                        <option value="paula-fraga">Paula Fraga</option>
                        <option value="ml-fotografia">ML Fotografia</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <label class="form-label">Estado</label>
                    <select class="form-control" id="estadoFilter" onchange="applyFilters()">
                        <option value="">Todos os Estados</option>
                        <option value="TO">Tocantins</option>
                        <option value="MA">Maranhão</option>
                        <option value="GO">Goiás</option>
                        <option value="PA">Pará</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <label class="form-label">Cidade</label>
                    <select class="form-control" id="cidadeFilter" onchange="applyFilters()">
                        <option value="">Todas as Cidades</option>
                        <option value="araguaina">Araguaína</option>
                        <option value="palmas">Palmas</option>
                        <option value="gurupi">Gurupi</option>
                        <option value="pedra-caida">Pedra Caída</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <button class="btn btn-outline-secondary w-100" onclick="clearFilters()" style="margin-top: 32px;">
                        <i class="bi bi-arrow-clockwise me-1"></i>Limpar
                    </button>
                </div>
            </div>
        </div>

        <!-- Loading -->
        <div id="loading" class="loading-spinner">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Carregando...</span>
            </div>
        </div>

        <!-- Photos Grid -->
        <div id="photosGrid" class="photo-grid" style="display: none;">
            <!-- Fotos serão carregadas aqui -->
        </div>

        <!-- Load More Button -->
        <div class="text-center mt-4">
            <button class="btn btn-outline-primary btn-lg" id="loadMoreBtn" onclick="loadMorePhotos()" style="display: none;">
                <i class="bi bi-arrow-down-circle me-2"></i>Carregar Mais Fotos
            </button>
        </div>
    </div>

    <!-- Photo Modal -->
    <div class="modal fade" id="photoModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalPhotoTitle">Título da Foto</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-8">
                            <div class="position-relative">
                                <img id="modalPhotoImage" src="" alt="" class="img-fluid rounded">
                                <div class="watermark">Fotos63 - Preview</div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="photo-details">
                                <h6>Descrição</h6>
                                <p id="modalPhotoDescription">Descrição da foto...</p>
                                
                                <h6>Fotógrafo</h6>
                                <div class="photographer-info mb-3">
                                    <img id="modalPhotographerAvatar" src="" alt="" class="photographer-avatar">
                                    <div>
                                        <div id="modalPhotographerName">Nome do Fotógrafo</div>
                                        <small class="text-muted" id="modalPhotographerLocation">Localização</small>
                                    </div>
                                </div>
                                
                                <h6>Categoria</h6>
                                <span class="badge bg-secondary mb-3" id="modalPhotoCategory">Categoria</span>
                                
                                <h6>Tags</h6>
                                <div id="modalPhotoTags" class="mb-3"></div>
                                
                                <h6>Informações Técnicas</h6>
                                <ul class="list-unstyled small text-muted mb-3">
                                    <li><i class="bi bi-camera me-1"></i>Resolução: Alta qualidade</li>
                                    <li><i class="bi bi-file-earmark me-1"></i>Formato: JPEG</li>
                                    <li><i class="bi bi-shield-check me-1"></i>Licença: Uso comercial</li>
                                </ul>
                                
                                <div class="mt-4">
                                    <div class="photo-price mb-3" id="modalPhotoPrice">R$ 0,00</div>
                                    
                                    <div class="login-prompt">
                                        <p class="mb-2"><i class="bi bi-info-circle me-1"></i><strong>Para comprar esta foto:</strong></p>
                                        <p class="small mb-3">Faça login ou crie uma conta gratuita</p>
                                        <div class="d-grid gap-2">
                                            <button class="btn btn-primary" onclick="showRegisterToBuy()">
                                                <i class="bi bi-person-plus me-2"></i>Criar Conta e Comprar
                                            </button>
                                            <button class="btn btn-outline-primary" onclick="showLoginToBuy()">
                                                <i class="bi bi-box-arrow-in-right me-2"></i>Já tenho conta
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="modal fade" id="loginModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-box-arrow-in-right me-2"></i>Entrar
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="loginForm">
                        <div class="mb-3">
                            <label class="form-label">E-mail</label>
                            <input type="email" class="form-control" id="loginEmail" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Senha</label>
                            <input type="password" class="form-control" id="loginPassword" required>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Entrar</button>
                    </form>
                    <div class="text-center mt-3">
                        <p class="mb-0">Não tem conta? <a href="#" onclick="switchToRegister()">Cadastre-se</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div class="modal fade" id="registerModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-person-plus me-2"></i>Criar nova conta
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="registerForm">
                        <div class="mb-3">
                            <label class="form-label">Nome Completo</label>
                            <input type="text" class="form-control" id="registerName" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">E-mail</label>
                            <input type="email" class="form-control" id="registerEmail" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Senha</label>
                            <input type="password" class="form-control" id="registerPassword" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Confirmar Senha</label>
                            <input type="password" class="form-control" id="registerConfirmPassword" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Tipo de Usuário</label>
                            <select class="form-control" id="registerUserType" required>
                                <option value="">Selecione...</option>
                                <option value="cliente">Cliente - Quero comprar fotos</option>
                                <option value="fotografo">Fotógrafo - Quero vender fotos</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Criar Conta</button>
                    </form>
                    <div class="text-center mt-3">
                        <p class="mb-0">Já tem conta? <a href="#" onclick="switchToLogin()">Faça login</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>Fotos63</h5>
                    <p>A maior plataforma de marketplace de fotos do Tocantins.</p>
                </div>
                <div class="col-md-6">
                    <h5>Links Úteis</h5>
                    <ul class="list-unstyled">
                        <li><a href="index.html" class="text-light">Início</a></li>
                        <li><a href="galeria.html" class="text-light">Galeria</a></li>
                        <li><a href="#" class="text-light">Sobre</a></li>
                        <li><a href="#" class="text-light">Contato</a></li>
                    </ul>
                </div>
            </div>
            <hr class="my-4">
            <p class="text-center mb-0">&copy; 2024 Fotos63. Desenvolvido por MtsFerreira</p>
        </div>
    </footer>

    <script>
        // Configuração do Supabase
        const supabaseUrl = 'https://wecgkxjlqeuhwpznauj.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndlY2dreGpscWV1aHdwem5hdWoiLCJyb2xlIjoiYW5vbiIsImlhdCI6MTczNDg5NzQ4MSwiZXhwIjoyMDUwNDczNDgxfQ.YBgLlBCLKdHJBfnhqBqZvJNKNjOhCNfGqKBfCJgJJJE';
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

        let allPhotos = [];
        let displayedPhotos = [];
        let currentFilter = '';
        let currentSearch = '';
        let currentSort = 'recent';
        let currentPhoto = null;
        let photosPerPage = 12;
        let currentPage = 0;

        // Carregar fotos
        async function loadPhotos() {
            try {
                const { data: photos, error } = await supabase
                    .from('fotos')
                    .select(`
                        *,
                        fotografos (
                            nome_completo,
                            avatar_url,
                            cidade
                        )
                    `)
                    .eq('status', 'ativa')
                    .order('created_at', { ascending: false });

                if (error) throw error;

                allPhotos = photos || [];
                updateStats();
                applyFiltersAndDisplay();
            } catch (error) {
                console.error('Erro ao carregar fotos:', error);
                showExamplePhotos();
            }

            document.getElementById('loading').style.display = 'none';
            document.getElementById('photosGrid').style.display = 'grid';
            document.getElementById('loadMoreBtn').style.display = 'block';
        }

        // Mostrar fotos de exemplo
        function showExamplePhotos() {
            const examplePhotos = [
                {
                    id: 1,
                    titulo: "Pôr do Sol no Jalapão",
                    descricao: "Linda paisagem do pôr do sol no Parque Estadual do Jalapão, capturando as cores douradas do cerrado tocantinense.",
                    preco: 25.00,
                    categoria: "natureza",
                    url_foto: "https://images.unsplash.com/photo-1469474968028-56623f02e42e?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    tags: ["jalapão", "pôr do sol", "natureza", "cerrado"],
                    visualizacoes: 245,
                    created_at: "2024-01-15",
                    fotografos: { 
                        nome_completo: "João Silva", 
                        avatar_url: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80",
                        cidade: "Palmas, TO"
                    }
                },
                {
                    id: 2,
                    titulo: "Casamento na Praia",
                    descricao: "Momento especial de um casal apaixonado durante cerimônia de casamento na beira do Rio Tocantins.",
                    preco: 45.00,
                    categoria: "eventos",
                    url_foto: "https://images.unsplash.com/photo-1511285560929-80b456fea0bc?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    tags: ["casamento", "praia", "amor", "cerimônia"],
                    visualizacoes: 189,
                    created_at: "2024-01-10",
                    fotografos: { 
                        nome_completo: "Maria Santos", 
                        avatar_url: "https://images.unsplash.com/photo-1494790108755-2616b612b786?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80",
                        cidade: "Araguaína, TO"
                    }
                },
                {
                    id: 3,
                    titulo: "Corrida de Rua",
                    descricao: "Atleta em ação durante competição de corrida de rua nas ruas de Palmas, demonstrando determinação e força.",
                    preco: 30.00,
                    categoria: "esportes",
                    url_foto: "https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    tags: ["corrida", "esporte", "atleta", "competição"],
                    visualizacoes: 156,
                    created_at: "2024-01-08",
                    fotografos: { 
                        nome_completo: "Carlos Lima", 
                        avatar_url: "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80",
                        cidade: "Palmas, TO"
                    }
                },
                {
                    id: 4,
                    titulo: "Arquitetura Moderna",
                    descricao: "Edifício moderno no centro de Palmas, mostrando a arquitetura contemporânea da capital tocantinense.",
                    preco: 35.00,
                    categoria: "arquitetura",
                    url_foto: "https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    tags: ["arquitetura", "moderno", "palmas", "urbano"],
                    visualizacoes: 98,
                    created_at: "2024-01-05",
                    fotografos: { 
                        nome_completo: "Ana Costa", 
                        avatar_url: "https://images.unsplash.com/photo-1438761681033-6461ffad8d80?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80",
                        cidade: "Palmas, TO"
                    }
                },
                {
                    id: 5,
                    titulo: "Retrato Artístico",
                    descricao: "Retrato em preto e branco capturando a essência e personalidade única do modelo.",
                    preco: 40.00,
                    categoria: "retratos",
                    url_foto: "https://images.unsplash.com/photo-1544005313-94ddf0286df2?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    tags: ["retrato", "preto e branco", "artístico", "modelo"],
                    visualizacoes: 203,
                    created_at: "2024-01-03",
                    fotografos: { 
                        nome_completo: "Pedro Oliveira", 
                        avatar_url: "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80",
                        cidade: "Gurupi, TO"
                    }
                },
                {
                    id: 6,
                    titulo: "Arte Abstrata",
                    descricao: "Composição artística abstrata usando elementos naturais do cerrado tocantinense.",
                    preco: 28.00,
                    categoria: "arte",
                    url_foto: "https://images.unsplash.com/photo-1541961017774-22349e4a1262?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    tags: ["arte", "abstrato", "cerrado", "composição"],
                    visualizacoes: 87,
                    created_at: "2024-01-01",
                    fotografos: { 
                        nome_completo: "Lucia Ferreira", 
                        avatar_url: "https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80",
                        cidade: "Porto Nacional, TO"
                    }
                }
            ];

            allPhotos = examplePhotos;
            updateStats();
            applyFiltersAndDisplay();
        }

        // Atualizar estatísticas
        function updateStats() {
            document.getElementById('totalPhotos').textContent = allPhotos.length;
            
            const photographers = [...new Set(allPhotos.map(p => p.fotografos?.nome_completo))];
            document.getElementById('totalPhotographers').textContent = photographers.length;
        }

        // Aplicar filtros e exibir
        function applyFiltersAndDisplay() {
            let filteredPhotos = [...allPhotos];

            // Aplicar filtro de categoria
            if (currentFilter) {
                filteredPhotos = filteredPhotos.filter(photo => photo.categoria === currentFilter);
            }

            // Aplicar busca
            if (currentSearch) {
                filteredPhotos = filteredPhotos.filter(photo => 
                    photo.titulo.toLowerCase().includes(currentSearch.toLowerCase()) ||
                    photo.descricao.toLowerCase().includes(currentSearch.toLowerCase()) ||
                    photo.fotografos?.nome_completo.toLowerCase().includes(currentSearch.toLowerCase()) ||
                    photo.tags?.some(tag => tag.toLowerCase().includes(currentSearch.toLowerCase()))
                );
            }

            // Aplicar ordenação
            switch (currentSort) {
                case 'price_asc':
                    filteredPhotos.sort((a, b) => a.preco - b.preco);
                    break;
                case 'price_desc':
                    filteredPhotos.sort((a, b) => b.preco - a.preco);
                    break;
                case 'popular':
                    filteredPhotos.sort((a, b) => (b.visualizacoes || 0) - (a.visualizacoes || 0));
                    break;
                case 'title':
                    filteredPhotos.sort((a, b) => a.titulo.localeCompare(b.titulo));
                    break;
                default: // recent
                    filteredPhotos.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
            }

            displayedPhotos = filteredPhotos;
            currentPage = 0;
            displayPhotos();
        }

        // Exibir fotos
        function displayPhotos() {
            const grid = document.getElementById('photosGrid');
            const startIndex = currentPage * photosPerPage;
            const endIndex = startIndex + photosPerPage;
            const photosToShow = displayedPhotos.slice(0, endIndex);

            if (currentPage === 0) {
                grid.innerHTML = '';
            }

            photosToShow.slice(startIndex).forEach(photo => {
                const photoCard = document.createElement('div');
                photoCard.className = 'photo-card';
                
                photoCard.innerHTML = `
                    <div class="position-relative">
                        <img src="${photo.url_foto}" alt="${photo.titulo}" loading="lazy">
                        <div class="photo-overlay">
                            <div>
                                <h6 class="text-white mb-1">${photo.titulo}</h6>
                                <p class="text-white-50 small mb-0">${photo.descricao?.substring(0, 60)}...</p>
                            </div>
                        </div>
                    </div>
                    <div class="photo-info">
                        <h6 class="mb-2">${photo.titulo}</h6>
                        <p class="text-muted small mb-2">${photo.descricao?.substring(0, 80)}...</p>
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="badge bg-secondary">${photo.categoria}</span>
                            <span class="photo-price">R$ ${photo.preco?.toFixed(2)}</span>
                        </div>
                        <div class="photographer-info mb-3">
                            <img src="${photo.fotografos?.avatar_url || 'https://via.placeholder.com/35'}" 
                                 alt="${photo.fotografos?.nome_completo}" class="photographer-avatar">
                            <div>
                                <small class="fw-bold">${photo.fotografos?.nome_completo}</small>
                                <br><small class="text-muted">${photo.fotografos?.cidade || 'Tocantins'}</small>
                            </div>
                        </div>
                        <div class="d-flex gap-2">
                            <button class="btn btn-primary btn-sm flex-grow-1" onclick="viewPhoto(${photo.id})">
                                <i class="bi bi-eye me-1"></i>Ver Detalhes
                            </button>
                            <small class="text-muted align-self-center">${photo.visualizacoes || 0} views</small>
                        </div>
                    </div>
                `;
                
                grid.appendChild(photoCard);
            });

            // Controlar botão "Carregar Mais"
            const loadMoreBtn = document.getElementById('loadMoreBtn');
            if (endIndex >= displayedPhotos.length) {
                loadMoreBtn.style.display = 'none';
            } else {
                loadMoreBtn.style.display = 'block';
            }
        }

        // Ver detalhes da foto
        function viewPhoto(photoId) {
            currentPhoto = allPhotos.find(p => p.id === photoId);
            if (!currentPhoto) return;

            document.getElementById('modalPhotoTitle').textContent = currentPhoto.titulo;
            document.getElementById('modalPhotoImage').src = currentPhoto.url_foto;
            document.getElementById('modalPhotoDescription').textContent = currentPhoto.descricao;
            document.getElementById('modalPhotographerName').textContent = currentPhoto.fotografos?.nome_completo;
            document.getElementById('modalPhotographerLocation').textContent = currentPhoto.fotografos?.cidade || 'Tocantins';
            document.getElementById('modalPhotographerAvatar').src = currentPhoto.fotografos?.avatar_url || 'https://via.placeholder.com/35';
            document.getElementById('modalPhotoCategory').textContent = currentPhoto.categoria;
            document.getElementById('modalPhotoPrice').textContent = `R$ ${currentPhoto.preco?.toFixed(2)}`;

            // Tags
            const tagsContainer = document.getElementById('modalPhotoTags');
            tagsContainer.innerHTML = '';
            if (currentPhoto.tags) {
                currentPhoto.tags.forEach(tag => {
                    const tagBadge = document.createElement('span');
                    tagBadge.className = 'badge bg-light text-dark me-1 mb-1';
                    tagBadge.textContent = `#${tag}`;
                    tagsContainer.appendChild(tagBadge);
                });
            }

            new bootstrap.Modal(document.getElementById('photoModal')).show();
        }

        // Filtrar por categoria
        function filterByCategory(category) {
            // Atualizar botões ativos
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            currentFilter = category;
            applyFiltersAndDisplay();
        }

        // Buscar fotos
        function searchPhotos() {
            currentSearch = document.getElementById('searchInput').value;
            applyFiltersAndDisplay();
        }

        // Ordenar fotos
        function sortPhotos() {
            currentSort = document.getElementById('sortSelect').value;
            applyFiltersAndDisplay();
        }

        // Carregar mais fotos
        function loadMorePhotos() {
            currentPage++;
            displayPhotos();
        }

        // Mostrar modal de login
        function showLogin() {
            new bootstrap.Modal(document.getElementById('loginModal')).show();
        }

        // Mostrar modal de registro
        function showRegister() {
            new bootstrap.Modal(document.getElementById('registerModal')).show();
        }

        // Mostrar registro para comprar
        function showRegisterToBuy() {
            bootstrap.Modal.getInstance(document.getElementById('photoModal')).hide();
            setTimeout(() => {
                document.getElementById('registerUserType').value = 'cliente';
                new bootstrap.Modal(document.getElementById('registerModal')).show();
            }, 300);
        }

        // Mostrar login para comprar
        function showLoginToBuy() {
            bootstrap.Modal.getInstance(document.getElementById('photoModal')).hide();
            setTimeout(() => {
                new bootstrap.Modal(document.getElementById('loginModal')).show();
            }, 300);
        }

        // Alternar para registro
        function switchToRegister() {
            bootstrap.Modal.getInstance(document.getElementById('loginModal')).hide();
            setTimeout(() => {
                new bootstrap.Modal(document.getElementById('registerModal')).show();
            }, 300);
        }

        // Alternar para login
        function switchToLogin() {
            bootstrap.Modal.getInstance(document.getElementById('registerModal')).hide();
            setTimeout(() => {
                new bootstrap.Modal(document.getElementById('loginModal')).show();
            }, 300);
        }

        // Processar login
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            try {
                const { data, error } = await supabase.auth.signInWithPassword({
                    email: email,
                    password: password
                });

                if (error) throw error;

                alert('Login realizado com sucesso!');
                bootstrap.Modal.getInstance(document.getElementById('loginModal')).hide();
                
                // Redirecionar baseado no tipo de usuário
                const { data: profile } = await supabase
                    .from('usuarios')
                    .select('tipo_usuario')
                    .eq('id', data.user.id)
                    .single();

                if (profile?.tipo_usuario === 'fotografo') {
                    window.location.href = 'dashboard-fotografo.html';
                } else {
                    window.location.href = 'dashboard-cliente.html';
                }
            } catch (error) {
                alert('Erro no login: ' + error.message);
            }
        });

        // Processar registro
        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;
            const userType = document.getElementById('registerUserType').value;

            if (password !== confirmPassword) {
                alert('As senhas não coincidem!');
                return;
            }

            try {
                const { data, error } = await supabase.auth.signUp({
                    email: email,
                    password: password,
                    options: {
                        data: {
                            full_name: name,
                            user_type: userType
                        }
                    }
                });

                if (error) throw error;

                alert('Conta criada com sucesso!');
                bootstrap.Modal.getInstance(document.getElementById('registerModal')).hide();
                
                // Redirecionar baseado no tipo de usuário
                if (userType === 'fotografo') {
                    window.location.href = 'dashboard-fotografo.html';
                } else {
                    window.location.href = 'dashboard-cliente.html';
                }
            } catch (error) {
                alert('Erro no cadastro: ' + error.message);
            }
        });

        // Inicialização
        document.addEventListener('DOMContentLoaded', () => {
            loadPhotos();
            
            // Busca ao pressionar Enter
            document.getElementById('searchInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    searchPhotos();
                }
            });
        });
    </script>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 col-md-6 mb-4">
                    <h5><i class="bi bi-camera-fill me-2"></i>Fotos63</h5>
                    <p>A maior plataforma de marketplace de fotos do Tocantins. Conectando fotógrafos talentosos com clientes que buscam qualidade.</p>
                    <div class="social-links">
                        <a href="#"><i class="bi bi-facebook"></i></a>
                        <a href="#"><i class="bi bi-instagram"></i></a>
                        <a href="#"><i class="bi bi-twitter"></i></a>
                        <a href="#"><i class="bi bi-whatsapp"></i></a>
                    </div>
                </div>
                
                <div class="col-lg-2 col-md-6 mb-4">
                    <h5>Navegação</h5>
                    <ul class="list-unstyled">
                        <li><a href="index.html">Início</a></li>
                        <li><a href="galeria.html">Galeria</a></li>
                        <li><a href="eventos.html">Eventos</a></li>
                        <li><a href="index.html#fotografos">Fotógrafos</a></li>
                        <li><a href="index.html#sobre">Sobre</a></li>
                    </ul>
                </div>
                
                <div class="col-lg-3 col-md-6">
                    <h5>Links Úteis</h5>
                    <ul class="list-unstyled">
                        <li><a href="#">Como Vender</a></li>
                        <li><a href="#">Como Comprar</a></li>
                        <li><a href="#">Suporte</a></li>
                        <li><a href="#">Contato</a></li>
                    </ul>
                </div>
                
                <div class="col-lg-2 col-md-6 mb-4">
                    <h5>Legal</h5>
                    <ul class="list-unstyled">
                        <li><a href="#">Termos de Uso</a></li>
                        <li><a href="#">Privacidade</a></li>
                        <li><a href="#">Cookies</a></li>
                        <li><a href="#">LGPD</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 Fotos63. Todos os direitos reservados. | Araguaína, TO | Desenvolvido por <strong>MtsFerreira</strong></p>
            </div>
        </div>
    </footer>
</body>
</html>

