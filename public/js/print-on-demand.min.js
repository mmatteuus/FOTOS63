class PrintOnDemandSystem{constructor(){this.providers={local:{name:"Gráfica Local",baseUrl:"/api/print/local",commission:.15,shippingTime:"3-5 dias úteis",regions:["TO","GO","MT","PA"]},nacional:{name:"Rede Nacional",baseUrl:"/api/print/nacional",commission:.2,shippingTime:"5-10 dias úteis",regions:"all"},premium:{name:"Premium Quality",baseUrl:"/api/print/premium",commission:.25,shippingTime:"7-15 dias úteis",regions:"all"}},this.productTypes={photo_print:{name:"Impressão de Foto",sizes:["10x15","13x18","15x21","20x30","30x40"],materials:["papel_fosco","papel_brilho","papel_metalico"],basePrice:5},canvas:{name:"Tela Canvas",sizes:["20x30","30x40","40x60","60x80","80x120"],materials:["canvas_algodao","canvas_premium"],basePrice:45},frame:{name:"Quadro com Moldura",sizes:["20x30","30x40","40x60","50x70"],materials:["moldura_madeira","moldura_aluminio","moldura_premium"],basePrice:65},album:{name:"Álbum de Fotos",sizes:["20x20","25x25","30x30"],materials:["capa_dura","capa_premium","capa_couro"],basePrice:85},mug:{name:"Caneca Personalizada",sizes:["300ml","350ml","500ml"],materials:["ceramica_branca","ceramica_colorida","ceramica_premium"],basePrice:25},tshirt:{name:"Camiseta Personalizada",sizes:["P","M","G","GG","XG"],materials:["algodao","poliester","premium"],basePrice:35},mousepad:{name:"Mouse Pad",sizes:["20x24","25x30"],materials:["tecido","borracha_premium"],basePrice:15},calendar:{name:"Calendário Personalizado",sizes:["A4","A3"],materials:["papel_couche","papel_premium"],basePrice:30}},this.initializeSystem()}initializeSystem(){this.loadPrintProviders(),this.setupPriceCalculation()}async loadPrintProviders(){try{const t=await fetch("/api/print/providers",{headers:{Authorization:`Bearer ${this.getAuthToken()}`}});if(t.ok){const e=await t.json();this.updateProviderCapabilities(e)}}catch(t){console.error("Error loading print providers:",t)}}createPrintInterface(t,e){const n=document.getElementById(t);n?(this.currentPhoto=e,n.innerHTML=`\n            <div class="print-on-demand">\n                <div class="print-header">\n                    <h3><i class="bi bi-printer"></i> Produtos Personalizados</h3>\n                    <p>Transforme esta foto em produtos físicos únicos</p>\n                </div>\n\n                <div class="photo-preview">\n                    <img src="${e.url}" alt="${e.title}" class="preview-image">\n                    <div class="photo-info">\n                        <h4>${e.title}</h4>\n                        <p>por ${e.photographerName}</p>\n                        <div class="photo-specs">\n                            <span><i class="bi bi-aspect-ratio"></i> ${e.dimensions||"Alta Resolução"}</span>\n                            <span><i class="bi bi-palette"></i> ${e.colorSpace||"RGB"}</span>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="product-categories">\n                    <div class="category-tabs">\n                        <button class="tab-btn active" data-category="all">Todos</button>\n                        <button class="tab-btn" data-category="wall">Parede</button>\n                        <button class="tab-btn" data-category="gifts">Presentes</button>\n                        <button class="tab-btn" data-category="clothing">Roupas</button>\n                        <button class="tab-btn" data-category="office">Escritório</button>\n                    </div>\n                </div>\n\n                <div class="products-grid" id="productsGrid">\n                    ${this.generateProductsGrid()}\n                </div>\n\n                <div class="product-configurator" id="productConfigurator" style="display: none;">\n                    <div class="configurator-header">\n                        <h4 id="configuratorTitle">Configurar Produto</h4>\n                        <button class="btn btn-sm btn-outline-secondary" onclick="closePrintConfigurator()">\n                            <i class="bi bi-x"></i>\n                        </button>\n                    </div>\n\n                    <div class="configurator-content">\n                        <div class="config-section">\n                            <label>Tamanho</label>\n                            <div class="size-options" id="sizeOptions">\n                                \x3c!-- Size options will be populated --\x3e\n                            </div>\n                        </div>\n\n                        <div class="config-section">\n                            <label>Material/Acabamento</label>\n                            <div class="material-options" id="materialOptions">\n                                \x3c!-- Material options will be populated --\x3e\n                            </div>\n                        </div>\n\n                        <div class="config-section">\n                            <label>Quantidade</label>\n                            <div class="quantity-selector">\n                                <button class="btn btn-outline-secondary" onclick="adjustQuantity(-1)">-</button>\n                                <input type="number" id="productQuantity" value="1" min="1" max="100">\n                                <button class="btn btn-outline-secondary" onclick="adjustQuantity(1)">+</button>\n                            </div>\n                            <small class="text-muted">Desconto progressivo a partir de 5 unidades</small>\n                        </div>\n\n                        <div class="config-section">\n                            <label>Fornecedor</label>\n                            <div class="provider-options" id="providerOptions">\n                                \x3c!-- Provider options will be populated --\x3e\n                            </div>\n                        </div>\n\n                        <div class="product-preview-section">\n                            <h5>Prévia do Produto</h5>\n                            <div class="product-mockup" id="productMockup">\n                                <div class="mockup-placeholder">\n                                    <i class="bi bi-image"></i>\n                                    <p>Selecione as opções para ver a prévia</p>\n                                </div>\n                            </div>\n                        </div>\n\n                        <div class="pricing-summary">\n                            <div class="price-breakdown">\n                                <div class="price-row">\n                                    <span>Produto base:</span>\n                                    <span id="basePrice">R$ 0,00</span>\n                                </div>\n                                <div class="price-row">\n                                    <span>Personalização:</span>\n                                    <span id="customizationPrice">R$ 0,00</span>\n                                </div>\n                                <div class="price-row">\n                                    <span>Frete:</span>\n                                    <span id="shippingPrice">Calcular</span>\n                                </div>\n                                <div class="price-row discount" id="discountRow" style="display: none;">\n                                    <span>Desconto:</span>\n                                    <span id="discountPrice">-R$ 0,00</span>\n                                </div>\n                                <div class="price-row total">\n                                    <span>Total:</span>\n                                    <span id="totalPrice">R$ 0,00</span>\n                                </div>\n                            </div>\n\n                            <div class="delivery-info">\n                                <i class="bi bi-truck"></i>\n                                <span id="deliveryTime">Prazo de entrega</span>\n                            </div>\n                        </div>\n\n                        <div class="shipping-calculator">\n                            <h5>Calcular Frete</h5>\n                            <div class="shipping-form">\n                                <input type="text" class="form-control" id="shippingZipCode" \n                                       placeholder="CEP de entrega" maxlength="9">\n                                <button class="btn btn-outline-primary" onclick="calculateShipping()">\n                                    <i class="bi bi-calculator"></i> Calcular\n                                </button>\n                            </div>\n                            <div class="shipping-options" id="shippingOptions" style="display: none;">\n                                \x3c!-- Shipping options will be populated --\x3e\n                            </div>\n                        </div>\n\n                        <div class="action-buttons">\n                            <button class="btn btn-outline-secondary" onclick="saveToWishlist()">\n                                <i class="bi bi-heart"></i> Salvar\n                            </button>\n                            <button class="btn btn-primary" onclick="addPrintToCart()" id="addToCartBtn">\n                                <i class="bi bi-cart-plus"></i> Adicionar ao Carrinho\n                            </button>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="print-cart" id="printCart" style="display: none;">\n                    <div class="cart-header">\n                        <h4><i class="bi bi-cart"></i> Carrinho de Produtos</h4>\n                        <span class="cart-count" id="cartCount">0 itens</span>\n                    </div>\n                    <div class="cart-items" id="cartItems">\n                        \x3c!-- Cart items will be populated --\x3e\n                    </div>\n                    <div class="cart-summary">\n                        <div class="summary-row">\n                            <span>Subtotal:</span>\n                            <span id="cartSubtotal">R$ 0,00</span>\n                        </div>\n                        <div class="summary-row">\n                            <span>Frete:</span>\n                            <span id="cartShipping">R$ 0,00</span>\n                        </div>\n                        <div class="summary-row total">\n                            <span>Total:</span>\n                            <span id="cartTotal">R$ 0,00</span>\n                        </div>\n                    </div>\n                    <div class="cart-actions">\n                        <button class="btn btn-outline-secondary" onclick="clearPrintCart()">\n                            Limpar Carrinho\n                        </button>\n                        <button class="btn btn-primary" onclick="proceedToCheckout()">\n                            Finalizar Pedido\n                        </button>\n                    </div>\n                </div>\n\n                <div class="print-info">\n                    <div class="info-tabs">\n                        <button class="info-tab active" data-tab="quality">Qualidade</button>\n                        <button class="info-tab" data-tab="shipping">Entrega</button>\n                        <button class="info-tab" data-tab="guarantee">Garantia</button>\n                    </div>\n                    \n                    <div class="info-content">\n                        <div class="info-panel active" id="quality-info">\n                            <h5>Qualidade Premium</h5>\n                            <ul>\n                                <li>Impressão em alta resolução (300 DPI mínimo)</li>\n                                <li>Cores vibrantes e duradouras</li>\n                                <li>Materiais de primeira qualidade</li>\n                                <li>Controle de qualidade rigoroso</li>\n                            </ul>\n                        </div>\n                        \n                        <div class="info-panel" id="shipping-info">\n                            <h5>Entrega Segura</h5>\n                            <ul>\n                                <li>Embalagem protetiva especializada</li>\n                                <li>Rastreamento completo do pedido</li>\n                                <li>Seguro contra danos no transporte</li>\n                                <li>Entrega em todo o Brasil</li>\n                            </ul>\n                        </div>\n                        \n                        <div class="info-panel" id="guarantee-info">\n                            <h5>Garantia Total</h5>\n                            <ul>\n                                <li>30 dias para troca ou devolução</li>\n                                <li>Reimpressão gratuita em caso de defeito</li>\n                                <li>Suporte técnico especializado</li>\n                                <li>100% de satisfação garantida</li>\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `,this.setupPrintEvents(),this.initializeCart()):console.error(`Container ${t} not found`)}generateProductsGrid(){return Object.entries(this.productTypes).map(([t,e])=>`\n            <div class="product-card" data-product="${t}" onclick="configurePrintProduct('${t}')">\n                <div class="product-image">\n                    <i class="bi bi-${this.getProductIcon(t)}"></i>\n                </div>\n                <div class="product-info">\n                    <h5>${e.name}</h5>\n                    <p class="product-price">A partir de ${this.formatCurrency(e.basePrice)}</p>\n                    <div class="product-features">\n                        <span><i class="bi bi-check"></i> Alta qualidade</span>\n                        <span><i class="bi bi-truck"></i> Entrega rápida</span>\n                    </div>\n                </div>\n                <div class="product-overlay">\n                    <button class="btn btn-primary">Personalizar</button>\n                </div>\n            </div>\n        `).join("")}getProductIcon(t){return{photo_print:"image",canvas:"easel",frame:"picture",album:"book",mug:"cup",tshirt:"person",mousepad:"mouse",calendar:"calendar"}[t]||"box"}setupPrintEvents(){document.querySelectorAll(".tab-btn").forEach(t=>{t.addEventListener("click",t=>{this.filterProductsByCategory(t.target.dataset.category)})}),document.querySelectorAll(".info-tab").forEach(t=>{t.addEventListener("click",t=>{this.switchInfoTab(t.target.dataset.tab)})}),document.getElementById("productQuantity").addEventListener("input",()=>{this.updatePricing()}),document.getElementById("shippingZipCode").addEventListener("input",t=>{let e=t.target.value.replace(/\D/g,"");e=e.replace(/(\d{5})(\d)/,"$1-$2"),t.target.value=e})}filterProductsByCategory(t){document.querySelectorAll(".tab-btn").forEach(t=>{t.classList.remove("active")}),document.querySelector(`[data-category="${t}"]`).classList.add("active");document.querySelectorAll(".product-card").forEach(e=>{const n=e.dataset.product,i="all"===t||this.getProductCategory(n)===t;e.style.display=i?"block":"none"})}getProductCategory(t){return{photo_print:"wall",canvas:"wall",frame:"wall",album:"gifts",mug:"gifts",tshirt:"clothing",mousepad:"office",calendar:"office"}[t]||"all"}switchInfoTab(t){document.querySelectorAll(".info-tab").forEach(t=>{t.classList.remove("active")}),document.querySelector(`[data-tab="${t}"]`).classList.add("active"),document.querySelectorAll(".info-panel").forEach(t=>{t.classList.remove("active")}),document.getElementById(`${t}-info`).classList.add("active")}configurePrintProduct(t){this.currentProduct=t;const e=this.productTypes[t];document.getElementById("productConfigurator").style.display="block",document.getElementById("configuratorTitle").textContent=`Configurar ${e.name}`,this.populateSizeOptions(e.sizes),this.populateMaterialOptions(e.materials),this.populateProviderOptions(),document.getElementById("productQuantity").value=1,this.updatePricing(),this.generateProductMockup()}populateSizeOptions(t){const e=document.getElementById("sizeOptions");e.innerHTML=t.map(t=>`\n            <label class="size-option">\n                <input type="radio" name="productSize" value="${t}">\n                <span class="size-label">${t}</span>\n            </label>\n        `).join(""),e.querySelector("input").checked=!0,e.querySelectorAll("input").forEach(t=>{t.addEventListener("change",()=>{this.updatePricing(),this.generateProductMockup()})})}populateMaterialOptions(t){const e=document.getElementById("materialOptions");e.innerHTML=t.map(t=>`\n            <label class="material-option">\n                <input type="radio" name="productMaterial" value="${t}">\n                <span class="material-label">${this.getMaterialDisplayName(t)}</span>\n                <span class="material-price">+${this.formatCurrency(this.getMaterialPrice(t))}</span>\n            </label>\n        `).join(""),e.querySelector("input").checked=!0,e.querySelectorAll("input").forEach(t=>{t.addEventListener("change",()=>{this.updatePricing(),this.generateProductMockup()})})}populateProviderOptions(){const t=document.getElementById("providerOptions");t.innerHTML=Object.entries(this.providers).map(([t,e])=>`\n            <label class="provider-option">\n                <input type="radio" name="productProvider" value="${t}">\n                <div class="provider-info">\n                    <span class="provider-name">${e.name}</span>\n                    <span class="provider-time">${e.shippingTime}</span>\n                </div>\n                <span class="provider-commission">+${(100*e.commission).toFixed(0)}%</span>\n            </label>\n        `).join(""),t.querySelector("input").checked=!0,t.querySelectorAll("input").forEach(t=>{t.addEventListener("change",()=>{this.updatePricing(),this.updateDeliveryTime()})})}getMaterialDisplayName(t){return{papel_fosco:"Papel Fosco",papel_brilho:"Papel Brilho",papel_metalico:"Papel Metálico",canvas_algodao:"Canvas Algodão",canvas_premium:"Canvas Premium",moldura_madeira:"Moldura Madeira",moldura_aluminio:"Moldura Alumínio",moldura_premium:"Moldura Premium",capa_dura:"Capa Dura",capa_premium:"Capa Premium",capa_couro:"Capa Couro",ceramica_branca:"Cerâmica Branca",ceramica_colorida:"Cerâmica Colorida",ceramica_premium:"Cerâmica Premium",algodao:"Algodão",poliester:"Poliéster",premium:"Premium",tecido:"Tecido",borracha_premium:"Borracha Premium",papel_couche:"Papel Couchê",papel_premium:"Papel Premium"}[t]||t}getMaterialPrice(t){return{papel_fosco:0,papel_brilho:2,papel_metalico:5,canvas_algodao:0,canvas_premium:15,moldura_madeira:0,moldura_aluminio:10,moldura_premium:25,capa_dura:0,capa_premium:20,capa_couro:40,ceramica_branca:0,ceramica_colorida:5,ceramica_premium:10,algodao:0,poliester:5,premium:15,tecido:0,borracha_premium:8,papel_couche:0,papel_premium:10}[t]||0}updatePricing(){if(!this.currentProduct)return;const t=this.productTypes[this.currentProduct],e=parseInt(document.getElementById("productQuantity").value)||1,n=document.querySelector('input[name="productSize"]:checked')?.value,i=document.querySelector('input[name="productMaterial"]:checked')?.value,a=document.querySelector('input[name="productProvider"]:checked')?.value;if(!n||!i||!a)return;const r=t.basePrice*this.getSizeMultiplier(n)+this.getMaterialPrice(i),o=r*e,s=o*this.providers[a].commission,c=o+s,l=this.calculateQuantityDiscount(e,o),d=c-l;document.getElementById("basePrice").textContent=this.formatCurrency(r),document.getElementById("customizationPrice").textContent=this.formatCurrency(s),document.getElementById("totalPrice").textContent=this.formatCurrency(d);const p=document.getElementById("discountRow");l>0?(p.style.display="flex",document.getElementById("discountPrice").textContent=`-${this.formatCurrency(l)}`):p.style.display="none"}getSizeMultiplier(t){return{"10x15":1,"13x18":1.2,"15x21":1.4,"20x30":1.8,"30x40":2.5,"40x60":3.5,"60x80":5,"80x120":7.5,P:1,M:1.1,G:1.2,GG:1.3,XG:1.4,"300ml":1,"350ml":1.1,"500ml":1.3,"20x20":1,"25x25":1.5,"30x30":2,"20x24":1,"25x30":1.3,A4:1,A3:1.5}[t]||1}calculateQuantityDiscount(t,e){return t>=20?.15*e:t>=10?.1*e:t>=5?.05*e:0}updateDeliveryTime(){const t=document.querySelector('input[name="productProvider"]:checked')?.value;t&&(document.getElementById("deliveryTime").textContent=this.providers[t].shippingTime)}generateProductMockup(){const t=document.getElementById("productMockup"),e=document.querySelector('input[name="productSize"]:checked')?.value,n=document.querySelector('input[name="productMaterial"]:checked')?.value;if(!e||!n)return;const i=this.generateMockupHtml(this.currentProduct,e,n);t.innerHTML=i}generateMockupHtml(t,e,n){const i=this.currentPhoto.url;switch(t){case"photo_print":return`\n                    <div class="mockup-photo-print">\n                        <div class="print-frame" style="aspect-ratio: ${this.getAspectRatio(e)};">\n                            <img src="${i}" alt="Preview">\n                        </div>\n                        <div class="mockup-info">\n                            <span>${e} - ${this.getMaterialDisplayName(n)}</span>\n                        </div>\n                    </div>\n                `;case"canvas":return`\n                    <div class="mockup-canvas">\n                        <div class="canvas-frame">\n                            <img src="${i}" alt="Preview">\n                        </div>\n                        <div class="mockup-info">\n                            <span>Tela ${e} - ${this.getMaterialDisplayName(n)}</span>\n                        </div>\n                    </div>\n                `;case"mug":return`\n                    <div class="mockup-mug">\n                        <div class="mug-container">\n                            <div class="mug-photo">\n                                <img src="${i}" alt="Preview">\n                            </div>\n                        </div>\n                        <div class="mockup-info">\n                            <span>Caneca ${e} - ${this.getMaterialDisplayName(n)}</span>\n                        </div>\n                    </div>\n                `;default:return`\n                    <div class="mockup-generic">\n                        <img src="${i}" alt="Preview">\n                        <div class="mockup-info">\n                            <span>${this.productTypes[t].name} ${e}</span>\n                        </div>\n                    </div>\n                `}}getAspectRatio(t){return{"10x15":"2/3","13x18":"13/18","15x21":"5/7","20x30":"2/3","30x40":"3/4","40x60":"2/3","60x80":"3/4"}[t]||"1/1"}async calculateShipping(){const t=document.getElementById("shippingZipCode").value.replace(/\D/g,"");if(8===t.length)try{const e=document.querySelector('input[name="productProvider"]:checked')?.value,n=parseInt(document.getElementById("productQuantity").value)||1,i=await fetch("/api/print/shipping/calculate",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.getAuthToken()}`},body:JSON.stringify({zipCode:t,provider:e,productType:this.currentProduct,quantity:n})});if(!i.ok)throw new Error("Erro ao calcular frete");const a=await i.json();this.displayShippingOptions(a)}catch(t){console.error("Shipping calculation error:",t),alert("Erro ao calcular frete: "+t.message)}else alert("Por favor, digite um CEP válido")}displayShippingOptions(t){const e=document.getElementById("shippingOptions");e.innerHTML=t.map(t=>`\n            <label class="shipping-option">\n                <input type="radio" name="shippingMethod" value="${t.code}">\n                <div class="shipping-info">\n                    <span class="shipping-name">${t.name}</span>\n                    <span class="shipping-time">${t.deliveryTime}</span>\n                </div>\n                <span class="shipping-price">${this.formatCurrency(t.price)}</span>\n            </label>\n        `).join(""),e.style.display="block",e.querySelectorAll("input").forEach(e=>{e.addEventListener("change",e=>{const n=t.find(t=>t.code===e.target.value);document.getElementById("shippingPrice").textContent=this.formatCurrency(n.price),this.updateTotalWithShipping(n.price)})}),t.length>0&&(e.querySelector("input").checked=!0,document.getElementById("shippingPrice").textContent=this.formatCurrency(t[0].price),this.updateTotalWithShipping(t[0].price))}updateTotalWithShipping(t){const e=this.parsePrice(document.getElementById("totalPrice").textContent)+t;document.getElementById("totalPrice").textContent=this.formatCurrency(e)}parsePrice(t){return parseFloat(t.replace(/[^\d,]/g,"").replace(",","."))||0}initializeCart(){this.printCart=JSON.parse(localStorage.getItem("fotos63_print_cart"))||[],this.updateCartDisplay()}addPrintToCart(){const t=this.collectProductData();t?(this.printCart.push({id:Date.now(),photoId:this.currentPhoto.id,photoUrl:this.currentPhoto.url,photoTitle:this.currentPhoto.title,...t,addedAt:(new Date).toISOString()}),localStorage.setItem("fotos63_print_cart",JSON.stringify(this.printCart)),this.updateCartDisplay(),alert("Produto adicionado ao carrinho!"),this.closePrintConfigurator()):alert("Por favor, configure todas as opções do produto")}collectProductData(){const t=document.querySelector('input[name="productSize"]:checked')?.value,e=document.querySelector('input[name="productMaterial"]:checked')?.value,n=document.querySelector('input[name="productProvider"]:checked')?.value,i=parseInt(document.getElementById("productQuantity").value)||1,a=document.querySelector('input[name="shippingMethod"]:checked')?.value;if(!t||!e||!n)return null;const r=this.parsePrice(document.getElementById("totalPrice").textContent),o=a?this.parsePrice(document.getElementById("shippingPrice").textContent):0;return{productType:this.currentProduct,productName:this.productTypes[this.currentProduct].name,size:t,material:this.getMaterialDisplayName(e),provider:this.providers[n].name,quantity:i,unitPrice:r/i,totalPrice:r,shippingMethod:a,shippingPrice:o}}updateCartDisplay(){const t=document.getElementById("cartCount"),e=document.getElementById("cartItems"),n=document.getElementById("cartSubtotal"),i=document.getElementById("cartShipping"),a=document.getElementById("cartTotal");if(!t)return;t.textContent=`${this.printCart.length} ${1===this.printCart.length?"item":"itens"}`,0===this.printCart.length?e.innerHTML='<p class="text-muted text-center">Carrinho vazio</p>':e.innerHTML=this.printCart.map(t=>`\n                <div class="cart-item">\n                    <img src="${t.photoUrl}" alt="${t.photoTitle}" class="cart-item-image">\n                    <div class="cart-item-info">\n                        <h6>${t.productName}</h6>\n                        <p>${t.size} - ${t.material}</p>\n                        <small>Qtd: ${t.quantity}</small>\n                    </div>\n                    <div class="cart-item-price">\n                        ${this.formatCurrency(t.totalPrice)}\n                    </div>\n                    <button class="btn btn-sm btn-outline-danger" onclick="removePrintFromCart(${t.id})">\n                        <i class="bi bi-trash"></i>\n                    </button>\n                </div>\n            `).join("");const r=this.printCart.reduce((t,e)=>t+e.totalPrice,0),o=this.printCart.reduce((t,e)=>t+(e.shippingPrice||0),0),s=r+o;n.textContent=this.formatCurrency(r),i.textContent=this.formatCurrency(o),a.textContent=this.formatCurrency(s),document.getElementById("printCart").style.display=this.printCart.length>0?"block":"none"}removePrintFromCart(t){this.printCart=this.printCart.filter(e=>e.id!==t),localStorage.setItem("fotos63_print_cart",JSON.stringify(this.printCart)),this.updateCartDisplay()}clearPrintCart(){confirm("Tem certeza que deseja limpar o carrinho?")&&(this.printCart=[],localStorage.setItem("fotos63_print_cart",JSON.stringify(this.printCart)),this.updateCartDisplay())}proceedToCheckout(){0!==this.printCart.length?window.location.href=`/checkout/print?items=${encodeURIComponent(JSON.stringify(this.printCart))}`:alert("Carrinho vazio")}closePrintConfigurator(){document.getElementById("productConfigurator").style.display="none",this.currentProduct=null}adjustQuantity(t){const e=document.getElementById("productQuantity"),n=parseInt(e.value)||1,i=Math.max(1,Math.min(100,n+t));e.value=i,this.updatePricing()}saveToWishlist(){this.collectProductData()?alert("Produto salvo na lista de desejos!"):alert("Por favor, configure todas as opções do produto")}formatCurrency(t){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t||0)}getAuthToken(){return localStorage.getItem("fotos63_auth_token")||""}}function configurePrintProduct(t){printOnDemand.configurePrintProduct(t)}function closePrintConfigurator(){printOnDemand.closePrintConfigurator()}function adjustQuantity(t){printOnDemand.adjustQuantity(t)}function calculateShipping(){printOnDemand.calculateShipping()}function addPrintToCart(){printOnDemand.addPrintToCart()}function removePrintFromCart(t){printOnDemand.removePrintFromCart(t)}function clearPrintCart(){printOnDemand.clearPrintCart()}function proceedToCheckout(){printOnDemand.proceedToCheckout()}function saveToWishlist(){printOnDemand.saveToWishlist()}const printOnDemand=new PrintOnDemandSystem;"undefined"!=typeof module&&module.exports&&(module.exports=PrintOnDemandSystem);